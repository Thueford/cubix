
\documentclass[a4paper,10pt,ngerman,fontsize=12pt]{scrreprt}
\usepackage[a4paper,left=2.5cm,right=2cm,top=1.8cm,bottom=1.5cm,includefoot]{geometry}

\usepackage{hyphsubst} %[ngerman=ngerman-x-latest]
\usepackage[onehalfspacing]{setspace}            % Zeilenabstand 1.5
\usepackage[ngerman]{babel}               % Sprache

\include{packages}
\include{macros}
\include{code}
\include{code_cs}

\graphicspath{{img/}{img/coll/}{img/enem/}{img/shot/}}

% Daten für Titelseite
\title{Kombinierte Belegarbeit \\ GameProgramming und \\ GPU Programmierung}
\author{Alexander Feilke, Jakob Massal{\ss}ky \\ Sem.Gr.: IF19wS-B}
%\date{}


%help: https://de.wikibooks.org/wiki/LaTeX-Wörterbuch
% \part \chapter \section \subsection \subsubsection \paragraph \subparagraph
% ß: {\ss}
% label{X} \nameref \pageref \fullref \vref {X}
% href{URL}{text}
% für Lit.Verz.: \cite[extra]{X,Y}



% Glossaries:
%\usepackage[chapter,toc]{glossaries}
%\newcommand{\printmyglossary}{\printunsrtglossaries}
%\newcommand{\printmyglossary}{\printglossaries}
%\makeglossaries % use TeX to sort
%\renewcommand{\glstextformat}[1]{\textit{#1}}
%\newglossaryentry{Basisklasse}{name={Basisklasse},
%description={Vererbt Eigenschaften an davon abgeleitete Klassen}}




\begin{document}

%\thispagestyle{empty}\quad\newpage % leeres Deckblatt
%\selectfont\sffamily
\normalfont

\maketitle
\newpage % Titelblatt

\renewcommand{\contentsname}{Inhaltsverzeichnis}
\tableofcontents
\newpage


\lefthyphenmin 5
\righthyphenmin 5
\sloppy
\flushbottom



\chapter{Aufgabenstellung}
\lipsum[3]





\chapter{Spielbeschreibung}

%Konzept, ~farben
Cubix ist ein Top-Down Bullet-Hell Shooter angelehnt an den Hacking-Mode aus Nier:Automata\cite{qNierHM}.
Dort steuert man eine Figur in einer Welt von Gegnern und Hindernissen und muss möglichst schnell und Fehlerfrei sämtliche Gegner durch gekonntes Ausweichen und gezielte Schüsse eliminieren.

Als Neuerung wird ein Farbkonzept verwendet, bei dem die Grundfarben Rot, Grün und Blau mit verschiedenen Eigenschaften assoziiert werden. Alle Akteure des Spiels (sowohl der Spieler selbst als auch die Gegner und aufsammelbare Objekte) können in Beliebiger Kombination dieser Farben auftreten. Ist mehr als eine Farbe aktiv, so addieren sich deren Eigenschaften. Dieses System ist für den Spieler leicht verständlich, denn das Wissen über die Eigenschaften der drei Grundfarben reicht aus, um die Ergebnisse jeder möglichen Kombination schon im Voraus zu erschlie{\ss}en. Diese Kombinationsmöglichkeiten sorgen aber trotz des simplen Systems für genug Abwechslung und Tiefe. Die einzige Ausnahme beim Kombinieren bilden die sammelbaren Objekte, dazu später mehr (siehe \fullref{sect:Collectables}).




\section{Spielziel}

Das Spiel ist aus verschiedenen Stufen (siehe \fullref{sect:stages}) aufgebaut, die vom Spieler abgeschlossen werden müssen.
Solange sich der Spieler im roten Ladebereich (Charger) in der Mitte des Spielfeldes aufhält, wird dieser aufgeladen.
Sobald der Charger aktiviert wird, fangen Gegner an zu erscheinen (spawnen). Diese können vom Spieler durch schie{\ss}en besiegt werden, sie selbst schie{\ss}en aber ebenfalls auf den Spieler und können ihm so schaden.
Ist der Charger voll geladen, hören die Gegner auf zu spawnen und ein Portal zur nächsten Stufe aktiviert.




\section{Schussmodi}

Der Spieler kann seinen Schüssen jeweils eine der Eigenschaften der drei Grundfarben verleihen, welche er im Tutorial der Reihe nach freischalten und ausprobieren kann:

\renewcommand{\itmspace}{4.5em}
\imgitmtxt{s_red.png}{Rote Kugeln}
{sind langsamer aber Explodieren beim Aufprall.}

\imgitmtxt{s_green.png}{Grüne Kugeln}
{sind schneller und fügen mehr Schaden zu, prallen von Wänden ab und durchdringen Gegner, haben aber eine geringere Schussrate.}

\imgitmtxt{s_blue.png}{Blaue Kugeln}
{werden in einem Fächer von fünf Kugeln in einer höheren Schussrate verschossen, fügen aber weniger Schaden zu.}




\section{Gegner}

Im Spiel gibt es drei verschiedene Gegnertypen, erkennbar an ihrer Form:

\renewcommand{\itmspace}{4.5em}
\imgitmtxt{e_hunter.png}{Hunter}
{jagen den Spieler um ihm Kollisionsschaden zuzufügen.}

\imgitmtxt{e_archer.png}{Archer}
{verfolgen den Spieler aber bleiben auf Abstand und schie{\ss}en aus der Ferne auf ihn.}

\imgitmtxt{e_stray.png}{Strays}
{irren langsam über das Spielfeld und feuern 4 Schüsse in alle Richtungen.}

Auch die Gegner können in drei verschiedenen Farben vorkommen:

\renewcommand{\itmspace}{7.5em}
\imgitmtxt{e_red.png}{Rote Gegner}
{sind langsam, haben aber mehr Leben.}

\imgitmtxt{e_green.png}{Grüne Gegner}
{bewegen sich schneller.}

\imgitmtxt{e_blue.png}{Blaue Gegner}
{Spawnen in Zweiergruppen, haben aber weniger Leben.}

\imgitmtxt{e_white.png}{Wei{\ss}e Gegner}
{spawnen als Kombination aller drei Farben und haben mehrere Boni. Sie sind so schnell wie grüne Gegner, haben etwas weniger Leben als Rote und spawnen ebenfalls in Gruppen.}




\section{Collectables}

Wenn Gegner besiegt werden, lassen sie mit einer gewissen Wahrscheinlichkeit aufsammelbare Objekte (Collectables) abhängig von ihrer eigenen Farbe fallen.

\renewcommand{\itmspace}{5.5em}
\imgitmtxt{c_black.png}{Schwarz}
{lässt den Spieler einen Lebenspunkt zurückerhalten.}

\imgitmtxt{c_blue.png}{Rot, Grün, Blau}
{verleihen dem Spieler Ressourcen in der entsprechenden Farbe.}

\imgitmtxt{c_yellow.png}{Gelb}
{lässt den Spieler für kurze Zeit in alle Richtungen feuern.}

\imgitmtxt{c_cyan.png}{Türkis}
{Erhöht kurzzeitig die Schussrate stark.}

\imgitmtxt{c_magenta.png}{Magenta}
{verleiht für einen kurzen Zeitraum Unsichtbarkeit/Unverwundbarkeit.}

\imgitmtxt{c_gold.png}{Gold}
{lässt einen goldenen Container fallen der bei Kontakt eine gro{\ss}e Explosion auslöst die sämtliche Gegner auf dem Spielfeld auslöscht. (Selten und nur von wei{\ss}en Gegnern erhältlich.)}




\section{Ressourcen}




\section{Tutorial}

Das Tutorial besteht aus einer Folge von 10 Stufen, in der dem Spieler der Reihe nach die Spielemechaniken nähergebracht werden. Diese werden durch Ereignisgesteuerte Texte unterstützt, die bereits im Hauptmenü beginnen, welches ebenfalls als eine Stufe designt ist, nur ohne Gegnerspawner. Die Abfolge ist wie folgt:

\begin{description}
\item[Hauptmenü] Steuerung, Objective
\item[Stufe 1] Gegner, Schie{\ss}en
\item[Stufe 2] erste Schussfarbe
\item[Stufe 3] einfarbige Gegner
\item[Stufe 4] zweite Schussfarbe
\item[Stufe 5] Farbkombimodus (Space)
\item[Stufe 6] mehrfarbige Gegner
\item[Stufe 7] dritte Schussfarbe
\item[Stufe 8] Probierstufe
\item[Stufe 9] wei{\ss}e Gegner (letzte Hürde)
\item[Stufe 10+] Endlosmodus
\end{description}





\chapter{Dokumentation}




\section{Software-Architektur}

\lipsum[1]

\begin{figure}[h!]
\begin{center}
\includegraphics[height=170pt]{cross.png}
\caption{Klassendiagramm}
\label{fig:classdiag}
\end{center}
\end{figure}
    



\section{Stages}
\label{sect:stages}


\subsection{Aufbau}

Eine Stufe besteht wesentlich aus 2 Gruppen von Komponenten: den statischen, unveränderlichen und den dynamisch generierten.

Zu den statischen gehören Wände, die den Spielbereich abgrenzen und ggf. Hindernisse auf dem Spielfeld darstellen, der Spawn auf dem der Spieler die Stufe betritt, das Portal durch dass der Spieler die Stufe verlässt um in die nächste Stufe zu kommen und der Charger den der Spieler aufladen muss, um das Portal zu aktivieren.

Zu den dynamischen gehören die Gegner, abgefeuerte Bullets, Collectables, ggf. dynamisch generierte Hindernisse sowie dazugehörige Partikeleffekte. Zudem kann es in einer Stufe ein oder mehrere für den Spieler unsichtbare Gegnerspawner (siehe \nameref{subsect:spawner}) geben.

Alle dynamischen Objekte werden in einem dafür angelegten Containerobjekt in der Stage hinterlegt, damit er in seiner Gesamtheit bein Entladen einer Stufe gelöscht werden kann.



\subsection{Tutorialstages}

Dsa Tutorial besteht aus geskripteten Stages mit voreingestellten Spawnern, Farbcollectables und Hinweistexten. Die Hinweistexte werden hierbei durch zu den Stages gehörigen Skripte gesteuert.



\subsection{Stagegenerator}

\lipsum[3]



\section{Spieler}

\lipsum[3]



\subsection{Input}

\lipsum[3]


\subsection{Movement}

\lipsum[3]


\subsection{Shooting}

\lipsum[3]


\subsection{Ressource}

\lipsum[3]




\section{Gegner}

\lipsum[3]



\subsection{Context-Steering}

Um das Gefecht interessanter zu machen wurde die Gegner-KI mit dem sog. Context-Steering Algorithmus\cite{qCtxSteer} (auch gen. Behavior-Driven Steering) ausgestattet.

Grundlegend wird hierbei jedem Objekt ein Wert zugeordnet der angibt, wie anstrebenswert es von bestimmten Entitäten ist. Ein positiver Wert ist hierbei ein Ziel, welches verfolgt wird, während ein negativer Wert ein zu vermeidendes Objekt darstellt.

In dieser Implementierung gibt es sog. Effektoren, die jeweils vier Werte speichern:

\begin{description}
\item[Zieltag] Zeichenkette, die die Gruppe an Objekten mit dieser Begehrlichkeit beschreibt
\item[Begehrlichkeitswert] wie anstrebenswert ein Objekt ist. Ein positiver Wert ist hierbei ein Ziel, welches verfolgt wird, während ein negativer Wert ein zu vermeidendes Objekt darstellt.
\item[Mindestabstand] Wie nah eine Entität sein muss, um von diesem Effektor beeinflusst zu werden
\item[Typ] Wie stark der Effektor abhängig vom Abstand wirkt. Das kann hier entweder logisch, linear oder quadratisch sein. 
\end{description}

Jede Entität bestimmt dann anhand der Formel $ clamp(typed(1 - dist / dist_{min}), 0, 1) * v_{dir} $ einen Vektor der die die Richtung und die Kraft zu diesem Objekt angibt.

Für die Erkennung von Wänden schaut jede Entität in in 30° Schritten um sich herum und schickt in jede dieser Richtungen einen Physik-Raycast. Von den Effektor-Vektoren wird dann  mittels Punktprodukt ein anteiliger Faktor in diese Richtung ermittelt und die resultierende Richtung durch die Summe dieser Richtungsvektoren ermittelt.

Für etwas mehr Abwechslung wird diese noch durch Perlin-Noise ein wenig abgeändert.

Da jede Gegnerart ein eigenes Verhalten hat, haben diese auch unterschiedliche Effektorenlisten. Strays besitzen nur das Standardverhalten und bewegen sich rein durch noise und vermeiden Wände und andere Gegner. Hunter haben zusätzlich eine Kraft zum Spieler hin und Archer wiederum noch einen Effektor mit kleinerem Radius vom Spieler weg, ebenfalls mit etwas Noise damit der Archer scheinbar vom SPieler strategisch vor- und zurückweicht.



\subsection{Gegnerspawner}
\label{subsect:spawner}

Die Gegnerspawner sind standardisierte Rechteck-Objekte, die unsichtbar für den Spieler einen Bereich markieren in dem Gegner mit einstellbaren Wahrscheinlichkeiten und Eigenschaften erscheinen:

\begin{description}
\item[Typverteilung] Wahrscheinlichkeitsverteilung der Gegnertypen.
\item[Farbverteilung] Wahrscheinlichkeitsverteilung der Farbmodifikatoren, abhängig von der Reihenfolge, in der die Schussfarben eingesammelt wurden.
\item[maxColors] maximale Anzahl an Farben die die Gegner haben können
\item[amount] maximale Anzahl an Gegner die dieser Spawner spawnt
\item[wavesize] Anzahl an Gegnern die der Spawner auf einmal spawnt (typischerweise 1-3)
\item[initDelay] Zeitspanne die der Spawner nach Aktivierung des Chargers wartet bis er anfängt Gegner zu spawnen
\item[delay] Zeitspanne zwischen Gegnerwellen
\item[variation] Zeitspanne, nach der einzelne Gegnerspawns verzögert werden
\end{description}

Zudem hat jede Stage eine Maximale Anzahl an Gegnern, die sich Zeitgleich in der Stage aufhalten können, damit der Spieler nicht von Gegnern überrant wird.

In jeder Stage können beliebig viele Spawner platziert werden, jedoch ist durch die verfügbaren Einstellungsmöglichkeiten schon mit einem einzelnen Spawner meist ausreichend Variabilität möglich. Mehrere Spawner werden erst vonnöten, wenn man in einer Stage zeitlich verteilt verschiedene Wellen spawnen möchte.




\section{Physics}

\lipsum[3]



\section{Sound}

\lipsum[3]




\chapter{Grafikeffekte}




\section{Shader in Unity}

\lipsum[3]



\section{Partikelsystem}

\lipsum[3]



\section{Postprocessing}

\lipsum[3]



\subsection{Bloom}
\lipsum[3]



\subsection{Chromatic Aberration}

\lipsum[3]



\subsection{Lens Flare}

\lipsum[3]



\subsection{Vignette, warped Display und Scanlines}

\lipsum[3]





\chapter{Assets und Tools}

\begin{description}
\item[Git] Versionsverwaltungstool
\item[Unity Engine] Game engine
\item[Unity Editor] Editor der Game Engine
\item[Microsoft Visual Studio] Code Editor mit Unity Integration
\item[Pro Builder] Simpler Mesh-Editor für Unity zum Erstellen der Entity-Modelle
\item[Ableton Live 10] Digital Audio Workstation zur Erstellung der Soundeffekte
\vspace{5mm}
\item[Modelle] Selbst erstellt mit Pro Builder
\item[Texturen] In Unity angelegt, ausschlie{\ss}lich einfarbig
\item[Audioeffekte] Selbst erstellt mit Ableton Live
\item[Soundtrack] Selbst erstellt mit Ableton Live

\end{description}






\chapter{Ausblick}

%Bossstages, Generischere Gegner, Generischere Stages, mehr testdaten
\lipsum[3]





\chapter{Fazit}

\lipsum[3]





\chapter{Glossar}

\begin{description}
\item[item1] itemdesc
\item[item2] itemdesc
\end{description}




\chapter{Dateiverzeichnis}
\dirtree{%
.1 Assets/.
.2 Animation/.
.2 Materials/. .3 Shader/.
.2 Prefabs/.
.3 Actors/. .4 Enemies/.
.3 StageElements/.
.3 Bases/.
.2 Resources/.
.2 Scenes/.
.2 Scripts/.
.3 Shader/.
.3 Stages/.
.3 Test/.
.3 Actors/. .4 Player/. .4 Enemies/.
.3 StageElements/.
.3 Bases/.
.3 Controller/.
.2 Shader/. .3 Particles/. .3 PostProcessing/.
}




\chapter{Quellenverzeichnis}

\begin{thebibliography}{999}

\bibitem{qNierHM} Nier:Automata Hacking-Mode Demo vom 23.04.2021,  Zugriff:  16.05.2021, \\ URL:
\url{https://www.youtube.com/watch?v=jT2jOeFo5HQ}

\bibitem{qCtxSteer} Context-Steering Demo vom 10.10.2020,  Zugriff:  19.05.2021, \\ URL:
\url{https://www.youtube.com/watch?v=6BrZryMz-ac}
\url{http://www.gameaipro.com/GameAIPro2/GameAIPro2_Chapter18_Context_Steering_Behavior-Driven_Steering_at_the_Macro_Scale.pdf}

\end{thebibliography}
    




\chapter{Eigenständigkeitserklärung}

Hiermit erklären wir Alexander Feilke und Jakom Massal{\ss}ky, dass wir die vorliegende Arbeit selbstständig verfasst und keine anderen als die angegebenen Quellen und Hilfsmittel benutzt haben.

Alle sinngemä{\ss} und wörtlich übernommenen Textstellen aus fremden Quellen wurden kenntlich gemacht.

Mittweida, den 10.08.2021

\vspace{2cm}

Alexander Feilke \hspace{4cm} Jakob Massal{\ss}ky





\newpage
\newpage
\chapter{Anhang}




\section{Installationsanleitung}

Laden Sie die Datei \href{https://www.dropbox.com/s/g82vexjznq1x9dd/Cubix.zip?dl=1}{Cubix.zip} herunter und entpacken Sie sie. Anschlie{\ss}end führen Sie die darin befindliche cubix.exe aus.
Im Falle einer Warnung vom Windows-Defender klicken Sie auf Mehr und Trotzdem ausführen - Die Warnung besagt nur, dass das Spiel von keinem offiziellen Hersteller veröffentlicht wurde.
Sie müssten nun einen Unity-Startbildschirm sehen und kurz darauf direkt im Spiel landen.




\section{Spielanleitung}

Du bist ein kleiner Würfel in einer Welt von Kugeln, Gegnern und Portalen. Versuche so viele Stufen wie möglich zu schaffen und dabei so wenige Fehler wie möglich zu machen. Wähle zwischen 3 Schussmodi aus, und wenn du in der Klemme steckst und genügend Ressourcen hast aktiviere den Farbkombinationsmodus und Rette damit deine Haut.



\subsection{Steuerung}
%TODO: Screenshots Spielfeld, Stageelemente, Farbschema, Pausemenü

Gesteuert wird mit WASD. Linksklick drücken und halten zum kontinuierlichen Abfeuern von Schüssen. Schussfarbe wechseln mit 1, 2 und 3 auf der Tastatur oder Numpad.

Wenn genügend Ressourcen vorhanden sind (mindestens 2 voll aufgeladene Balken) Drücke Space, um für eine Zeit lang kombinierte Farbschüsse abzugeben.

Pausiert wird das Spiel mit Escape.





\end{document}
